Title: 某网站密码重置漏洞
Date: 2014-07-01 11:12
Tags: 密码重置


密码重置，涉及到流程和逻辑的处理，很容易出现设计错误，而且这种设计错误基本上无法用工具扫描发现，此功能还是一个非正常的业务功能，各大厂商的测试力度估计也不够。虽然不会导致服务器沦陷、数据库泄露，但会对正常用户造成注册信息的泄露，帐户无法使用，用户对平台的信赖等问题。查询wooyun上的涉及密码重置的问题也很多，大多问题也基本类似，今日无意间发现一个小网站也存在类似问题，就借此机会练练手。                                                                                                                                          
                                                                                                                                                                           


#### **1、密码重置过程回放**

1、进入密码找回页面

![Alt text](/static/images/forget-1.GIF)

2、输入需要找回密码的QQ或者邮箱信息

![Alt text](/static/images/forget-2.GIF)

3、输入需要的验证码

![Alt text](/static/images/forget-3.GIF)

4、通过邮件查看，验证码很简单，只是一个6位的随机数

![Alt text](/static/images/forget-4.GIF)

5、输入验证码即可进行重置密码页面

![Alt text](/static/images/forget-5.GIF)


#### **2、问题描述**

密码找回设计有问题，在用户输入的验证码页面上，并没有防止用户爆破的功能，如验证码、重试次数的限制，导致存在可以利用的漏洞


#### **3、利用方法**

使用burpsuite抓取验证码提交的页面，对6位数字进行爆破，爆破成功的页面如下

![Alt text](/static/images/forget-6.GIF)


#### **4、修复方法**

1、重置验证码增加防爆破处理，如增加一个需在手动输入的验证码或者错误次数的限制

2、增加一个重置密码的连接需要用户点击，而不是输入验证码



